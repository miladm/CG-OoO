\hypertarget{listSchedule_8cpp}{
\section{/home/milad/esc\_\-project/svn/PARS/src/binaryTranslator/listSchedule.cpp File Reference}
\label{listSchedule_8cpp}\index{/home/milad/esc\_\-project/svn/PARS/src/binaryTranslator/listSchedule.cpp@{/home/milad/esc\_\-project/svn/PARS/src/binaryTranslator/listSchedule.cpp}}
}
{\ttfamily \#include \char`\"{}listSchedule.h\char`\"{}}\par
Include dependency graph for listSchedule.cpp:
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{listSchedule_8cpp_aa79c6fb1ba7cac942c3f3df4b4adb0ff}{findLongestPath} (\hyperlink{classinstruction}{instruction} $\ast$ins, \hyperlink{classbasicblock}{basicblock} $\ast$bb)
\item 
void \hyperlink{listSchedule_8cpp_af9a47861fb738dfb09aa240667f01b1e}{listSchedule} (\hyperlink{classbasicblock}{basicblock} $\ast$bb)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{listSchedule_8cpp_aa79c6fb1ba7cac942c3f3df4b4adb0ff}{
\index{listSchedule.cpp@{listSchedule.cpp}!findLongestPath@{findLongestPath}}
\index{findLongestPath@{findLongestPath}!listSchedule.cpp@{listSchedule.cpp}}
\subsubsection[{findLongestPath}]{\setlength{\rightskip}{0pt plus 5cm}int findLongestPath (
\begin{DoxyParamCaption}
\item[{{\bf instruction} $\ast$}]{ins, }
\item[{{\bf basicblock} $\ast$}]{bb}
\end{DoxyParamCaption}
)}}
\label{listSchedule_8cpp_aa79c6fb1ba7cac942c3f3df4b4adb0ff}

\begin{DoxyCode}
                                                      {
        List<instruction*> *_dependents = ins->getDependents();
        int _critPathLen = -1;
        for (int i = 0; i < _dependents->NumElements(); i++) {
                instruction* dep = _dependents->Nth(i);
                int pathLength;
                if (bb->isInsAddrInBB(dep->getInsAddr()) == false) continue;
                if (dep->isLongestPathSet() == true) pathLength = dep->
      getLongestPath();
                else pathLength = findLongestPath(dep, bb);
                if (_critPathLen < pathLength) _critPathLen = pathLength;
        }
        if (_critPathLen == -1) {
                _critPathLen = ins->getLatency();
        } else {
                _critPathLen += ins->getLatency();
        }
        Assert (_critPathLen > 0);
        return _critPathLen;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{listSchedule_8cpp_af9a47861fb738dfb09aa240667f01b1e}{
\index{listSchedule.cpp@{listSchedule.cpp}!listSchedule@{listSchedule}}
\index{listSchedule@{listSchedule}!listSchedule.cpp@{listSchedule.cpp}}
\subsubsection[{listSchedule}]{\setlength{\rightskip}{0pt plus 5cm}void listSchedule (
\begin{DoxyParamCaption}
\item[{{\bf basicblock} $\ast$}]{bb}
\end{DoxyParamCaption}
)}}
\label{listSchedule_8cpp_af9a47861fb738dfb09aa240667f01b1e}

\begin{DoxyCode}
                                  {
        List<instruction*> *sortList      = new List<instruction*>;
        List<instruction*> *listSchList   = new List<instruction*>;
        List<instruction*> *toBeSchedList = new List<instruction*>;
        List<instruction*> *insList       = bb->getInsList();
        set<ADDR> scheduledIns;
        bool scheduleIt = false;
        // Replicate the BB instruction list
        for (int i = 0; i < insList->NumElements(); i++) {
                insList->Nth(i)->resetLongestPath(); //Added to alow Phraesblock 
      listscheduling (not useful for BB-list scheduling)
                sortList->Append(insList->Nth(i));
        }
        // Find the longest path for every instruction in BB
        for (int i = sortList->NumElements()-1; i >= 0; i--) {
                int lp = findLongestPath(sortList->Nth(i), bb);
                sortList->Nth(i)->setLongestPath(lp);
                // printf("lp for ins %llu: %d\n", sortList->Nth(i)->getInsAddr()
      , lp);
    }
        // printf("\n");
        // Sort instruction list based on critical path length (high to low)
        quicksortLongestPath(sortList,0,sortList->NumElements()-1);
        // List schedule instructions based on their data-dependency chains.
        while (sortList->NumElements() != scheduledIns.size()) {
                int scheduleCounter = 0;
            for (int i = 0; i < sortList->NumElements() && scheduleCounter < 
      NUM_EU; i++) {
                        instruction* ins = sortList->Nth(i);
                        if (scheduledIns.find(ins->getInsAddr()) != scheduledIns.
      end()) continue;
                        List<instruction*>* ancestors = ins->getAncestors();
                        scheduleIt = true;
                        for (int j = 0; j < ancestors->NumElements(); j++) {
                                instruction* anc = ancestors->Nth(j);
                                if (bb->isInsAddrInBB(anc->getInsAddr()) == true 
      &&
                                    scheduledIns.find(anc->getInsAddr()) == sched
      uledIns.end()) {
                                                // printf("hey ");
                                                scheduleIt = false;
                                                continue;
                                }
                        }
                        // printf("\n");
                        if (scheduleIt == true) {
                                listSchList->Append(ins);
                                toBeSchedList->Append(ins);
                                scheduleCounter++;
                        }
            }
                // printf("To SChedule #: %d\n", toBeSchedList->NumElements());
                for (int i = 0; i < toBeSchedList->NumElements(); i++)
                        scheduledIns.insert(toBeSchedList->Nth(i)->getInsAddr());
      
                toBeSchedList->RemoveAll();
        }
        // Store the list-scheduled list to BB class
    for (int i = 0; i < listSchList->NumElements(); i++) {
                bb->addToBB_ListSchedule(listSchList->Nth(i));
                // printf("lp for ins %llu: %d\n", listSchList->Nth(i)->getInsAdd
      r(), listSchList->Nth(i)->getLongestPath());
    }
        // printf("\n---------\n");
        delete toBeSchedList;
        delete listSchList;
        delete sortList;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


