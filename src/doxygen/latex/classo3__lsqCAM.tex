\hypertarget{classo3__lsqCAM}{
\section{o3\_\-lsqCAM Class Reference}
\label{classo3__lsqCAM}\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}}
}


{\ttfamily \#include $<$lsq.h$>$}



Inheritance diagram for o3\_\-lsqCAM:


Collaboration diagram for o3\_\-lsqCAM:
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classo3__lsqCAM_a1ad55f822a48b91004a5081e88952362}{o3\_\-lsqCAM} (\hyperlink{classsysClock}{sysClock} $\ast$, const \hyperlink{classYAML_1_1Node}{YAML::Node} \&, string)
\item 
\hyperlink{classo3__lsqCAM_a5bc53f5f972f4d902325bc702efe8491}{$\sim$o3\_\-lsqCAM} ()
\item 
\hyperlink{classdynInstruction}{dynInstruction} $\ast$ \hyperlink{classo3__lsqCAM_a7db68789c8d9af13bbc9ec485b4972bc}{findPendingMemIns} (\hyperlink{global_2global_8h_a3bb5a7f1114a20672e012bf0dfe5fb24}{LSQ\_\-ID})
\item 
void \hyperlink{classo3__lsqCAM_a25372198cf9ceb3037dd0d027006eb08}{setTimer} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$, \hyperlink{global_2global_8h_a7e19a550ec11d1ed921deb20c22efb5b}{CYCLE})
\item 
void \hyperlink{classo3__lsqCAM_a95e286b95f3651e40d57206eb2a41308}{squash} (\hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID})
\item 
void \hyperlink{classo3__lsqCAM_aa7fdfa8e6591d754e194c7052e7e17d3}{delFinishedMemAxes} ()
\item 
bool \hyperlink{classo3__lsqCAM_ad3d6f79a7377317fc859080d337d428a}{hasCommit} ()
\item 
bool \hyperlink{classo3__lsqCAM_ac52c64978b8fbe0569bb67f0d77e2ec9}{hasMemAddr} (\hyperlink{binaryTranslator_2frontend_2stInstruction_8h_a7ea74bb9ffd2e4d41550ae2383dd25bc}{ADDRS}, \hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID})
\item 
\hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID} \hyperlink{classo3__lsqCAM_ad0ef7ab14e36284321707f52bfe32d9f}{hasAnyCompleteStFromAddr} (\hyperlink{binaryTranslator_2frontend_2stInstruction_8h_a7ea74bb9ffd2e4d41550ae2383dd25bc}{ADDRS}, \hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID})
\item 
pair$<$ bool, \hyperlink{classdynInstruction}{dynInstruction} $\ast$ $>$ \hyperlink{classo3__lsqCAM_a603e22c5cb8d5049e843de830158b4e4}{hasAnyCompleteLdFromAddr} (\hyperlink{binaryTranslator_2frontend_2stInstruction_8h_a7ea74bb9ffd2e4d41550ae2383dd25bc}{ADDRS}, \hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID}, \hyperlink{global_2global_8h_a1883c47d0023d0f200e1d86eced6a070}{INS\_\-ID})
\item 
pair$<$ bool, \hyperlink{classdynInstruction}{dynInstruction} $\ast$ $>$ \hyperlink{classo3__lsqCAM_a08fc977c038420904ea7186c55515ae8}{hasFinishedIns} (\hyperlink{global_2global_8h_a3bb5a7f1114a20672e012bf0dfe5fb24}{LSQ\_\-ID})
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classo3__lsqCAM_a1ad55f822a48b91004a5081e88952362}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!o3\_\-lsqCAM@{o3\_\-lsqCAM}}
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{o3\_\-lsqCAM}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-lsqCAM::o3\_\-lsqCAM (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} $\ast$}]{clk, }
\item[{const {\bf YAML::Node} \&}]{root, }
\item[{string}]{table\_\-name}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a1ad55f822a48b91004a5081e88952362}

\begin{DoxyCode}
    : CAMtable<dynInstruction*> (clk, root, table_name)
{}
\end{DoxyCode}
\hypertarget{classo3__lsqCAM_a5bc53f5f972f4d902325bc702efe8491}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!$\sim$o3\_\-lsqCAM@{$\sim$o3\_\-lsqCAM}}
\index{$\sim$o3\_\-lsqCAM@{$\sim$o3\_\-lsqCAM}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{$\sim$o3\_\-lsqCAM}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-lsqCAM::$\sim$o3\_\-lsqCAM (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a5bc53f5f972f4d902325bc702efe8491}

\begin{DoxyCode}
{}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classo3__lsqCAM_aa7fdfa8e6591d754e194c7052e7e17d3}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!delFinishedMemAxes@{delFinishedMemAxes}}
\index{delFinishedMemAxes@{delFinishedMemAxes}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{delFinishedMemAxes}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-lsqCAM::delFinishedMemAxes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_aa7fdfa8e6591d754e194c7052e7e17d3}

\begin{DoxyCode}
                                    {
    CYCLE now = _clk->now ();
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = 0; i < table_size; i++) {
        if (_table.Nth(i)->_delay.isValidStopTime () &&
            _table.Nth(i)->_delay.getStopTime () <= now) {
            Assert (getNth_unsafe (i)->getSQstate () == SQ_CACHE_DISPATCH);
            dynInstruction* ins = pullNth (i);
            dbg.print (DBG_MEMORY, "%s: %s %llu\n", _c_name.c_str (), 
                       "Found a finished ST ins: ", ins->getInsID ());
            delete ins;
            break; /*-- REMOVE ONE ELEM PER INVOCATION (pullNth DELETED OBJ'S MOR
      E THAN ONE REM CAN CAUSE A BUG) --*/
        }
        dbg.print (DBG_MEMORY, "%s: %s %ld (cyc: %ld)\n", _c_name.c_str (), 
                   "No finished ST ins.", _table.Nth(0)->_delay.isValidStopTime (
      ), now);
    }
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_a7db68789c8d9af13bbc9ec485b4972bc}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!findPendingMemIns@{findPendingMemIns}}
\index{findPendingMemIns@{findPendingMemIns}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{findPendingMemIns}]{\setlength{\rightskip}{0pt plus 5cm}{\bf dynInstruction} $\ast$ o3\_\-lsqCAM::findPendingMemIns (
\begin{DoxyParamCaption}
\item[{{\bf LSQ\_\-ID}}]{lsq\_\-id}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a7db68789c8d9af13bbc9ec485b4972bc}

\begin{DoxyCode}
                                                           {
    if (lsq_id == ST_QU) {
        LENGTH table_size = _table.NumElements ();
        for (LENGTH i = 0; i < table_size; i++) {
            dynInstruction* ins = getNth_unsafe (i);
            if (ins->getPipeStage () == COMMIT &&
                ins->getSQstate () == SQ_COMMIT) {
                dbg.print (DBG_MEMORY, "%s: %s %llu\n", _c_name.c_str (), "ST ins
       issued:", ins->getInsID ());
                return getNth_unsafe (i);
            }
        }
        dbg.print (DBG_MEMORY, "%s: %s\n", _c_name.c_str (), "No ST ins issued.")
      ;
        return NULL; /*-- NOTHING ISSUED --*/
    } else { /*-- LD_QU --*/
        LENGTH table_size = _table.NumElements ();
        for (LENGTH i = 0; i < table_size; i++) {
            dynInstruction* ins = getNth_unsafe (i);
            if (ins->getPipeStage () == MEM_ACCESS &&
                ins->getLQstate () == LQ_PENDING_CACHE_DISPATCH) {
                dbg.print (DBG_MEMORY, "%s: %s %llu\n", _c_name.c_str (), "LD ins
       issued:", ins->getInsID ());
                return getNth_unsafe (i);
            }
        }
        dbg.print (DBG_MEMORY, "%s: %s\n", _c_name.c_str (), "No LD ins issued.")
      ;
        return NULL; /*-- NOTHING ISSUED --*/
    }
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_a603e22c5cb8d5049e843de830158b4e4}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!hasAnyCompleteLdFromAddr@{hasAnyCompleteLdFromAddr}}
\index{hasAnyCompleteLdFromAddr@{hasAnyCompleteLdFromAddr}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{hasAnyCompleteLdFromAddr}]{\setlength{\rightskip}{0pt plus 5cm}pair$<$ bool, {\bf dynInstruction} $\ast$ $>$ o3\_\-lsqCAM::hasAnyCompleteLdFromAddr (
\begin{DoxyParamCaption}
\item[{{\bf ADDRS}}]{completed\_\-st\_\-mem\_\-addr, }
\item[{{\bf INS\_\-ID}}]{lo\_\-seq\_\-num, }
\item[{{\bf INS\_\-ID}}]{hi\_\-seq\_\-num}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a603e22c5cb8d5049e843de830158b4e4}

\begin{DoxyCode}
                                                                                 
                                                       {
    LENGTH table_size = _table.NumElements ();
    if (table_size > 0 && hi_seq_num == NO_WAW_ST_INS) 
        hi_seq_num = getNth_unsafe(table_size - 1)->getInsID ();
    for (LENGTH i = table_size - 1; i > 0; i--) {
        dynInstruction* ins = getNth_unsafe (i);
        if (ins->getInsID () > hi_seq_num) continue;
        if (ins->getInsID () <= lo_seq_num) break;
        if (ins->getMemAddr () == completed_st_mem_addr) {
            if (ins->getLQstate () == LQ_COMPLETE && ins->isCacheAxes ()) {
                return pair<bool, dynInstruction*> (true, ins); //TODO double ceh
      ck that this means a register write has happened in the stage
            } else if (ins->getLQstate () == LQ_FWD_FROM_SQ ||
                       ins->getLQstate () == LQ_MSHR_WAIT ||
                       ins->getLQstate () == LQ_CACHE_WAIT) {
                //TODO implement this block - FWD from SQ - return false 
                //TODO check that at ADDR_WAIT state, later on the value in SQ
                //will be picked up and so we don't have to worry about that
                //here
            }
        }
    }
    return pair<bool, dynInstruction*> (false, NULL);
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_ad0ef7ab14e36284321707f52bfe32d9f}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!hasAnyCompleteStFromAddr@{hasAnyCompleteStFromAddr}}
\index{hasAnyCompleteStFromAddr@{hasAnyCompleteStFromAddr}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{hasAnyCompleteStFromAddr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf INS\_\-ID} o3\_\-lsqCAM::hasAnyCompleteStFromAddr (
\begin{DoxyParamCaption}
\item[{{\bf ADDRS}}]{completed\_\-st\_\-mem\_\-addr, }
\item[{{\bf INS\_\-ID}}]{st\_\-seq\_\-num}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_ad0ef7ab14e36284321707f52bfe32d9f}

\begin{DoxyCode}
                                                                                 
               {
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = 0; i < table_size; i++) {
        dynInstruction* st_ins = getNth_unsafe (i);
        if (st_ins->getInsID () <= st_seq_num) continue;
        if (st_ins->getSQstate () != SQ_COMPLETE) continue;
        if (st_ins->getMemAddr () == completed_st_mem_addr) 
            return st_ins->getInsID ();
    }
    return NO_WAW_ST_INS; /* NO MATCHING YOUNGER STORE WITH SAME MEM ADDR FOUND *
      /
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_ad3d6f79a7377317fc859080d337d428a}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!hasCommit@{hasCommit}}
\index{hasCommit@{hasCommit}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{hasCommit}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-lsqCAM::hasCommit (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_ad3d6f79a7377317fc859080d337d428a}

\begin{DoxyCode}
                           {
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = 0; i < table_size; i++) {
        if (getNth_unsafe (i)->getSQstate () == SQ_COMMIT) {
            return true;
        }
    }
    return false;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_a08fc977c038420904ea7186c55515ae8}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!hasFinishedIns@{hasFinishedIns}}
\index{hasFinishedIns@{hasFinishedIns}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{hasFinishedIns}]{\setlength{\rightskip}{0pt plus 5cm}pair$<$ bool, {\bf dynInstruction} $\ast$ $>$ o3\_\-lsqCAM::hasFinishedIns (
\begin{DoxyParamCaption}
\item[{{\bf LSQ\_\-ID}}]{lsq\_\-id}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a08fc977c038420904ea7186c55515ae8}

\begin{DoxyCode}
                                                                    {
    CYCLE now = _clk->now ();
    LENGTH table_size = _table.NumElements ();
    if (lsq_id == LD_QU) {
        for (LENGTH i = 0; i < table_size; i++) {
            dynInstruction* ins = getNth_unsafe (i);
            if ((ins->getLQstate () == LQ_FWD_FROM_SQ ||
                 ins->getLQstate () == LQ_MSHR_WAIT ||
                 ins->getLQstate () == LQ_CACHE_WAIT) &&
                 _table.Nth(i)->_delay.isValidStopTime () &&
                 _table.Nth(i)->_delay.getStopTime () <= now) {
                CYCLE stop_time = _table.Nth(i)->_delay.getStopTime ();
                dbg.print (DBG_MEMORY, "%s: %s %llu %llu (cyc: %llu)\n", _c_name.
      c_str (), 
                           "Found a finished LD ins: ", ins->getInsID (), stop_ti
      me, now);
                return pair<bool, dynInstruction*> (true, ins);
            }
        }
        dbg.print (DBG_MEMORY, "%s: %s\n", _c_name.c_str (), "No finished LD ins.
      ");
        return pair<bool, dynInstruction*> (false, NULL);
    } else {
        for (LENGTH i = 0; i < table_size; i++) {
            dynInstruction* ins = getNth_unsafe (i);
            if (ins->getSQstate () == SQ_CACHE_DISPATCH &&
                _table.Nth(i)->_delay.isValidStopTime () &&
                _table.Nth(i)->_delay.getStopTime () <= now) {
                CYCLE stop_time = _table.Nth(i)->_delay.getStopTime ();
                dbg.print (DBG_MEMORY, "%s: %s %llu %llu (cyc: %llu)\n", _c_name.
      c_str (), 
                           "Found a finished ST ins: ", ins->getInsID (), stop_ti
      me, now);
                return pair<bool, dynInstruction*> (true, ins);
            }
        }
        dbg.print (DBG_MEMORY, "%s: %s\n", _c_name.c_str (), "No finished ST ins.
      ");
        return pair<bool, dynInstruction*> (false, NULL);
    }
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_ac52c64978b8fbe0569bb67f0d77e2ec9}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!hasMemAddr@{hasMemAddr}}
\index{hasMemAddr@{hasMemAddr}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{hasMemAddr}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-lsqCAM::hasMemAddr (
\begin{DoxyParamCaption}
\item[{{\bf ADDRS}}]{mem\_\-addr, }
\item[{{\bf INS\_\-ID}}]{seq\_\-num}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_ac52c64978b8fbe0569bb67f0d77e2ec9}

\begin{DoxyCode}
                                                          {
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = table_size - 1; i >= 0; i--) {
        dynInstruction* ins = getNth_unsafe (i);
        PIPE_STAGE stage = ins->getPipeStage ();
        if (seq_num <= ins->getInsID ()) continue;
        if (g_var.g_mem_model == NAIVE_SPECUL &&
         ! (stage == COMPLETE || stage == COMMIT)) continue;
        if (ins->getMemAddr () == mem_addr) {
            return true;
        }
    }
    return false;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_a25372198cf9ceb3037dd0d027006eb08}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!setTimer@{setTimer}}
\index{setTimer@{setTimer}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{setTimer}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-lsqCAM::setTimer (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{elem, }
\item[{{\bf CYCLE}}]{axes\_\-lat}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a25372198cf9ceb3037dd0d027006eb08}

\begin{DoxyCode}
                                                              {
    CYCLE now = _clk->now ();
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = 0; i < table_size; i++) {
        dynInstruction* ins = getNth_unsafe (i);
        if (ins->getInsID () == elem->getInsID ()) {
            dbg.print (DBG_MEMORY, "%s: %s %llu (lat: %d)\n", _c_name.c_str (), 
                       "Set mem access lat. for ins:", ins->getInsID (), axes_lat
      );
            _table.Nth(i)->_delay.setNewTime (now, axes_lat);
            Assert (_table.Nth(i)->_delay.isValidStopTime () == true);
            return;
        }
    }
    Assert (true == false && "The LSQ enetry not found.");
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__lsqCAM_a95e286b95f3651e40d57206eb2a41308}{
\index{o3\_\-lsqCAM@{o3\_\-lsqCAM}!squash@{squash}}
\index{squash@{squash}!o3_lsqCAM@{o3\_\-lsqCAM}}
\subsubsection[{squash}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-lsqCAM::squash (
\begin{DoxyParamCaption}
\item[{{\bf INS\_\-ID}}]{ins\_\-seq\_\-num}
\end{DoxyParamCaption}
)}}
\label{classo3__lsqCAM_a95e286b95f3651e40d57206eb2a41308}

\begin{DoxyCode}
                                          {
    LENGTH table_size = _table.NumElements ();
    for (LENGTH i = table_size - 1; i >= 0; i--) {
        dynInstruction* ins = getNth_unsafe (i);
        if (ins->getInsID () >= ins_seq_num) {
            delete _table.Nth (i);
            _table.RemoveAt (i);
            dbg.print (DBG_MEMORY, "%s: %s %llu %s %llu\n", _c_name.c_str (), 
                       "Removing ins:", ins->getInsID (), "due to", ins_seq_num);
      
        } else {
            break;
        }
    }
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:




The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2lsq_8h}{lsq.h}\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2lsq_8cpp}{lsq.cpp}\end{DoxyCompactItemize}
