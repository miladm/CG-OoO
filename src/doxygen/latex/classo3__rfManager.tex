\hypertarget{classo3__rfManager}{
\section{o3\_\-rfManager Class Reference}
\label{classo3__rfManager}\index{o3\_\-rfManager@{o3\_\-rfManager}}
}


{\ttfamily \#include $<$rfManager.h$>$}



Inheritance diagram for o3\_\-rfManager:


Collaboration diagram for o3\_\-rfManager:
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classo3__rfManager_aeacfb1db7844c9f204b5b75ce38d671d}{o3\_\-rfManager} (\hyperlink{classsysClock}{sysClock} $\ast$, const \hyperlink{classYAML_1_1Node}{YAML::Node} \&, string rf\_\-name=\char`\"{}o3\_\-rfManager\char`\"{})
\item 
\hyperlink{classo3__rfManager_a42a66fc34794ca6c7209f743557a2b3a}{$\sim$o3\_\-rfManager} ()
\item 
bool \hyperlink{classo3__rfManager_a023f3671f90123fe8749ff13606f273c}{canRename} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
bool \hyperlink{classo3__rfManager_a702dcade81b3d2ccba4bae0ef8d7de30}{renameRegs} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
bool \hyperlink{classo3__rfManager_a785b7804c89faffdaee23e25c2cc3568}{checkReadyAgain} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
bool \hyperlink{classo3__rfManager_a9b85902c553b147228d0bb3b57280ca7}{isReady} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
void \hyperlink{classo3__rfManager_a06b8854ab37feb6b44166a8565dc447a}{completeRegs} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
void \hyperlink{classo3__rfManager_a7d3aa6c1316bac1153b24b7764d301fb}{commitRegs} (\hyperlink{classdynInstruction}{dynInstruction} $\ast$ins)
\item 
void \hyperlink{classo3__rfManager_ac8199decc9c7a881b2099a68711cced7}{squashRenameReg} ()
\item 
void \hyperlink{classo3__rfManager_a55bbc6fec2cb3736926e27bf112d7365}{regStat} ()
\item 
bool \hyperlink{classo3__rfManager_a7cfd1869c23bd1c4d6a5dc994ee29817}{hasFreeWire} (\hyperlink{binaryTranslator_2global_8h_a94b8423a23b95a7adac22848b81e7c0c}{AXES\_\-TYPE}, \hyperlink{global_2global_8h_a6fa2e24b8a418fa215e183264cbea3aa}{WIDTH})
\item 
void \hyperlink{classo3__rfManager_aeaf7e17c11cc6c75a342c3c32b25c546}{updateWireState} (\hyperlink{binaryTranslator_2global_8h_a94b8423a23b95a7adac22848b81e7c0c}{AXES\_\-TYPE}, \hyperlink{global_2global_8h_a6fa2e24b8a418fa215e183264cbea3aa}{WIDTH}, bool update\_\-wire=false)
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classo3__rfManager_aeacfb1db7844c9f204b5b75ce38d671d}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!o3\_\-rfManager@{o3\_\-rfManager}}
\index{o3\_\-rfManager@{o3\_\-rfManager}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{o3\_\-rfManager}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-rfManager::o3\_\-rfManager (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} $\ast$}]{clk, }
\item[{const {\bf YAML::Node} \&}]{root, }
\item[{string}]{rf\_\-name = {\ttfamily \char`\"{}o3\_\-rfManager\char`\"{}}}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_aeacfb1db7844c9f204b5b75ce38d671d}

\begin{DoxyCode}
    : unit (rf_name, clk),
      _GRF (clk, root["rf"], "registerRename"),
      _e_rf (rf_name + ".rf", root["rf"]),
      _e_rat (rf_name + ".rat", root["rat"]),
      _e_apr (rf_name + ".apr", root["apr"]),
      _e_arst (rf_name + ".arst" , root["arst"]),
      _e_w_rr (rf_name + ".rr.wire", root["rat"]),
      s_rf_not_ready_cnt (g_stats.newScalarStat (rf_name, "rf_not_ready_cnt", "Nu
      mber of RF operand-not-ready events", 0, PRINT_ZERO)),
      s_cant_rename_cnt (g_stats.newScalarStat (rf_name, "cant_rename_cnt", "Numb
      er of failed reg. rename attempts", 0, NO_PRINT_ZERO)),
      s_can_rename_cnt (g_stats.newScalarStat (rf_name, "can_rename_cnt", "Number
       of success reg. rename attempts", 0, NO_PRINT_ZERO)),
      s_unavailable_cnt (g_stats.newScalarStat (rf_name, "unavailable_cnt", "Numb
      er of unavailable wire accesses", 0, NO_PRINT_ZERO))
{ }
\end{DoxyCode}
\hypertarget{classo3__rfManager_a42a66fc34794ca6c7209f743557a2b3a}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!$\sim$o3\_\-rfManager@{$\sim$o3\_\-rfManager}}
\index{$\sim$o3\_\-rfManager@{$\sim$o3\_\-rfManager}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{$\sim$o3\_\-rfManager}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-rfManager::$\sim$o3\_\-rfManager (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a42a66fc34794ca6c7209f743557a2b3a}

\begin{DoxyCode}
{ }
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classo3__rfManager_a023f3671f90123fe8749ff13606f273c}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!canRename@{canRename}}
\index{canRename@{canRename}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{canRename}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-rfManager::canRename (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a023f3671f90123fe8749ff13606f273c}

\begin{DoxyCode}
                                                 {
    List<AR>* ar_wr = ins->getARwrList ();
    if (_GRF.getNumAvailablePR () < ar_wr->NumElements ()) {
        s_cant_rename_cnt++;
        return false; /*-- STALL FETCH --*/
    }
    s_can_rename_cnt++;
    return true;
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a785b7804c89faffdaee23e25c2cc3568}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!checkReadyAgain@{checkReadyAgain}}
\index{checkReadyAgain@{checkReadyAgain}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{checkReadyAgain}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-rfManager::checkReadyAgain (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a785b7804c89faffdaee23e25c2cc3568}

\begin{DoxyCode}
                                                       {
    List<AR>* p_rdReg_list = ins->getPRrdList ();
    for (int i = p_rdReg_list->NumElements () - 1; i >= 0; i--) {
        AR reg = p_rdReg_list->Nth (i);
        if (!_GRF.isPRvalid (reg)) {
            dbg.print (DBG_REG_FILES, "%s: %s %d (cyc: %d)\n", _c_name.c_str (), 
      
                    "RF read ops are ready: NO", "for ins: ", ins->getInsID (), 
      _clk->now ());
            return false; /*-- OPERAND NOT AVAILABLE --*/
        }
    }

    if (p_rdReg_list->NumElements () == 0) {
        dbg.print (DBG_REG_FILES, "%s: %s %d %s (cyc: %d)\n", _c_name.c_str (), 
                "RF operand of ins", ins->getInsID (), "are ready", _clk->now ())
      ;
        return true; /*-- ALL OPERANDS AVAILABLE --*/
    }

    dbg.print (DBG_REG_FILES, "%s: %s %d s (cyc: %d)\n", _c_name.c_str (), 
            "RF operand of ins", ins->getInsID (), "are ready", _clk->now ());
    return false; /*-- NOT ALL OPERANDS AVAILABLE --*/
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a7d3aa6c1316bac1153b24b7764d301fb}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!commitRegs@{commitRegs}}
\index{commitRegs@{commitRegs}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{commitRegs}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-rfManager::commitRegs (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a7d3aa6c1316bac1153b24b7764d301fb}

\begin{DoxyCode}
                                                  {
    List<PR>* _pr = ins->getPRwrList ();
    List<PR>* _ar = ins->getARwrList ();
    Assert (_ar->NumElements () == _pr->NumElements ());
    for (int i = 0; i < _pr->NumElements (); i++) {
        PR p_reg = _pr->Nth (i);
        AR a_reg = _ar->Nth (i);
        PR prev_pr = _GRF.getPrevPR (p_reg);
        _e_arst.ramAccess ();
        _GRF.updatePRstate (p_reg,ARCH_REG);
        _GRF.updatePRstate (prev_pr,AVAILABLE);
        _GRF.update_cRAT (a_reg,p_reg);
        _e_rat.ramAccess ();
        _GRF.setAsAvailablePR (prev_pr);
        _e_apr.ramAccess ();
    }
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a06b8854ab37feb6b44166a8565dc447a}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!completeRegs@{completeRegs}}
\index{completeRegs@{completeRegs}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{completeRegs}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-rfManager::completeRegs (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a06b8854ab37feb6b44166a8565dc447a}

\begin{DoxyCode}
                                                    {
    List<PR>* _pr = ins->getPRwrList ();
    for (int i = 0; i < _pr->NumElements (); i++) {
        PR p_reg = _pr->Nth (i);
        _GRF.updatePRstate (p_reg, RENAMED_VALID);
        _e_rf.ramAccess ();
    }
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a7cfd1869c23bd1c4d6a5dc994ee29817}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!hasFreeWire@{hasFreeWire}}
\index{hasFreeWire@{hasFreeWire}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{hasFreeWire}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-rfManager::hasFreeWire (
\begin{DoxyParamCaption}
\item[{{\bf AXES\_\-TYPE}}]{axes\_\-type, }
\item[{{\bf WIDTH}}]{numRegWires}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a7cfd1869c23bd1c4d6a5dc994ee29817}

\begin{DoxyCode}
                                                                      {
    if (_GRF.getNumFreeWires (axes_type) >= numRegWires) {
        return true;
    } else {
        s_unavailable_cnt++;
        return false;
    }
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a9b85902c553b147228d0bb3b57280ca7}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!isReady@{isReady}}
\index{isReady@{isReady}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{isReady}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-rfManager::isReady (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a9b85902c553b147228d0bb3b57280ca7}

\begin{DoxyCode}
                                               {
    List<AR>* p_rdReg_list = ins->getPRrdList ();
    for (int i = p_rdReg_list->NumElements () - 1; i >= 0; i--) {
        AR reg = p_rdReg_list->Nth (i);
        if (!_GRF.isPRvalid (reg)) {
            s_rf_not_ready_cnt++;
            dbg.print (DBG_REG_FILES, "%s: %s %d (cyc: %d)\n", _c_name.c_str (), 
      
                    "RF read ops are ready: NO", "for ins: ", ins->getInsID (), 
      _clk->now ());
            return false; /*-- OPERAND NOT AVAILABLE --*/
        } else {
            p_rdReg_list->RemoveAt (i); /*-- OPTIMIZATION --*/
        }
    }
    if (p_rdReg_list->NumElements () == 0) {
        _e_rf.ramAccess (ins->getTotNumRdAR ());
        dbg.print (DBG_REG_FILES, "%s: %s %d (cyc: %d)\n", _c_name.c_str (), 
                "RF read ops are ready: YES", "for ins: ", ins->getInsID (), 
      _clk->now ());
        return true; /*-- ALL OPERANDS AVAILABLE --*/
    }
    dbg.print (DBG_REG_FILES, "%s: %s %d (cyc: %d)\n", _c_name.c_str (), 
            "RF read ops are ready: NO", "for ins: ", ins->getInsID (), _clk->
      now ());
    s_rf_not_ready_cnt++;
    return false; /*-- NOT ALL OPERANDS AVAILABLE --*/
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a55bbc6fec2cb3736926e27bf112d7365}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!regStat@{regStat}}
\index{regStat@{regStat}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{regStat}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-rfManager::regStat (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a55bbc6fec2cb3736926e27bf112d7365}

\begin{DoxyCode}
                            {
    _GRF.getStat ();
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_a702dcade81b3d2ccba4bae0ef8d7de30}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!renameRegs@{renameRegs}}
\index{renameRegs@{renameRegs}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{renameRegs}]{\setlength{\rightskip}{0pt plus 5cm}bool o3\_\-rfManager::renameRegs (
\begin{DoxyParamCaption}
\item[{{\bf dynInstruction} $\ast$}]{ins}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_a702dcade81b3d2ccba4bae0ef8d7de30}

\begin{DoxyCode}
                                                  {
    List<AR>* ar_rd = ins->getARrdList ();
    List<AR>* ar_wr = ins->getARwrList ();
    Assert (_GRF.getNumAvailablePR () >= ar_wr->NumElements ());

    /*-- RENAME READ REFISTERS FIRST --*/
    for (int i = 0; i < ar_rd->NumElements (); i++) {
        AR a_reg = ar_rd->Nth (i);
        PR p_reg = _GRF.renameReg (a_reg);
        ins->setPR (p_reg, READ);
        _e_rat.ramAccess ();
    }

    /*-- RENAME WRITE REFISTERS SECOND --*/
    for (int i = 0; i < ar_wr->NumElements (); i++) {
        Assert (_GRF.isAnyPRavailable () == true && "A physical reg must have bee
      n available.");
        AR a_reg = ar_wr->Nth (i);
        PR prev_pr = _GRF.renameReg (a_reg);
        _e_rat.ramAccess ();
        PR new_pr = _GRF.getAvailablePR ();
        _e_apr.ramAccess ();
        _GRF.update_fRAT (a_reg, new_pr);
        _e_rat.ramAccess ();
        _GRF.updatePR (new_pr, prev_pr, RENAMED_INVALID);
        _e_arst.ramAccess ();
        ins->setPR (new_pr, WRITE);
    }

    /*-- WIRE ENERGY HANDLING --*/
    list<string> wires;
    WIDTH num_elements = 1; //opcode
    num_elements += (ins->getNumRdAR () + ins->getNumWrAR ());
    for (int i = 0; i < num_elements; i++) {
        wires.push_back ("e_w_cache2rr");
    }
    _e_w_rr.wireAccess (wires);

    return false; /*-- DON'T STALL FETCH --*/
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_ac8199decc9c7a881b2099a68711cced7}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!squashRenameReg@{squashRenameReg}}
\index{squashRenameReg@{squashRenameReg}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{squashRenameReg}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-rfManager::squashRenameReg (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_ac8199decc9c7a881b2099a68711cced7}

\begin{DoxyCode}
                                    {
    dbg.print (DBG_TEST, "** %s: %s (cyc:)\n", _c_name.c_str (), "in squash for R
      R");
    _GRF.squashRenameReg ();
    /* TODO model the ARST and APR table energies for squash */
}
\end{DoxyCode}


Here is the call graph for this function:


\hypertarget{classo3__rfManager_aeaf7e17c11cc6c75a342c3c32b25c546}{
\index{o3\_\-rfManager@{o3\_\-rfManager}!updateWireState@{updateWireState}}
\index{updateWireState@{updateWireState}!o3_rfManager@{o3\_\-rfManager}}
\subsubsection[{updateWireState}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-rfManager::updateWireState (
\begin{DoxyParamCaption}
\item[{{\bf AXES\_\-TYPE}}]{axes\_\-type, }
\item[{{\bf WIDTH}}]{numRegWires, }
\item[{bool}]{update\_\-wire = {\ttfamily false}}
\end{DoxyParamCaption}
)}}
\label{classo3__rfManager_aeaf7e17c11cc6c75a342c3c32b25c546}

\begin{DoxyCode}
                                                                                 
                 {
    list<string> wires;
    if (update_wire) {
        if (axes_type == READ) {
            wires.push_back ("e_w_eu2rf");
        } else if (axes_type == WRITE) {
            wires.push_back ("e_w_eu2rf");
        }
    }

    for (WIDTH i = 0; i < numRegWires; i++) {
        _GRF.updateWireState (axes_type, wires, update_wire);
    }
}
\end{DoxyCode}


Here is the call graph for this function:




The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2rfManager_8h}{rfManager.h}\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2rfManager_8cpp}{rfManager.cpp}\end{DoxyCompactItemize}
