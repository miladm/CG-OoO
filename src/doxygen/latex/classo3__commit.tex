\hypertarget{classo3__commit}{
\section{o3\_\-commit Class Reference}
\label{classo3__commit}\index{o3\_\-commit@{o3\_\-commit}}
}


{\ttfamily \#include $<$commit.h$>$}



Inheritance diagram for o3\_\-commit:


Collaboration diagram for o3\_\-commit:
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classo3__commit_ad39c647c50b97d4243d30a94a73855c7}{o3\_\-commit} (\hyperlink{classport}{port}$<$ \hyperlink{classdynInstruction}{dynInstruction} $\ast$ $>$ \&commit\_\-to\_\-bp\_\-port, \hyperlink{classport}{port}$<$ \hyperlink{classdynInstruction}{dynInstruction} $\ast$ $>$ \&commit\_\-to\_\-scheduler\_\-port, \hyperlink{classCAMtable}{CAMtable}$<$ \hyperlink{classdynInstruction}{dynInstruction} $\ast$ $>$ $\ast$\hyperlink{backend_2parser_8cpp_ad73ae25f81e6e99482f3fbd5ba9664ce}{iROB}, \hyperlink{global_2global_8h_a6fa2e24b8a418fa215e183264cbea3aa}{WIDTH} commit\_\-width, string stage\_\-name)
\item 
\hyperlink{classo3__commit_a9ececc230499566621371fab58aae228}{$\sim$o3\_\-commit} ()
\item 
void \hyperlink{classo3__commit_a54270cad3a81c7cce6f418517a927b98}{doCOMMIT} (\hyperlink{classsysClock}{sysClock} \&)
\item 
\hyperlink{unit_2stage_8h_ab00e4188e8b8974fecb1dfd12764cbb1}{PIPE\_\-ACTIVITY} \hyperlink{classo3__commit_a87f66e559f7376364630df8b3907e8cd}{commitImpl} (\hyperlink{classsysClock}{sysClock} \&)
\item 
void \hyperlink{classo3__commit_a12cc9b965c48bdf58ede84426c78287b}{squash} (\hyperlink{classsysClock}{sysClock} \&clk)
\item 
void \hyperlink{classo3__commit_a32f24b682cb40b48ac43bcbeb1c8b67d}{regStat} (\hyperlink{classsysClock}{sysClock} \&clk)
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classo3__commit_ad39c647c50b97d4243d30a94a73855c7}{
\index{o3\_\-commit@{o3\_\-commit}!o3\_\-commit@{o3\_\-commit}}
\index{o3\_\-commit@{o3\_\-commit}!o3_commit@{o3\_\-commit}}
\subsubsection[{o3\_\-commit}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-commit::o3\_\-commit (
\begin{DoxyParamCaption}
\item[{{\bf port}$<$ {\bf dynInstruction} $\ast$ $>$ \&}]{commit\_\-to\_\-bp\_\-port, }
\item[{{\bf port}$<$ {\bf dynInstruction} $\ast$ $>$ \&}]{commit\_\-to\_\-scheduler\_\-port, }
\item[{{\bf CAMtable}$<$ {\bf dynInstruction} $\ast$ $>$ $\ast$}]{iROB, }
\item[{{\bf WIDTH}}]{commit\_\-width, }
\item[{string}]{stage\_\-name}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_ad39c647c50b97d4243d30a94a73855c7}

\begin{DoxyCode}
        : stage (commit_width, stage_name),
      s_squash_ins_cnt (g_stats.newScalarStat ( _stage_name, "squash_ins_cnt", "N
      umber of squashed instructions", 0, PRINT_ZERO))
{
        _commit_to_bp_port  = &commit_to_bp_port;
        _commit_to_scheduler_port = &commit_to_scheduler_port;
    _iROB = iROB;
}
\end{DoxyCode}
\hypertarget{classo3__commit_a9ececc230499566621371fab58aae228}{
\index{o3\_\-commit@{o3\_\-commit}!$\sim$o3\_\-commit@{$\sim$o3\_\-commit}}
\index{$\sim$o3\_\-commit@{$\sim$o3\_\-commit}!o3_commit@{o3\_\-commit}}
\subsubsection[{$\sim$o3\_\-commit}]{\setlength{\rightskip}{0pt plus 5cm}o3\_\-commit::$\sim$o3\_\-commit (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_a9ececc230499566621371fab58aae228}

\begin{DoxyCode}
{}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classo3__commit_a87f66e559f7376364630df8b3907e8cd}{
\index{o3\_\-commit@{o3\_\-commit}!commitImpl@{commitImpl}}
\index{commitImpl@{commitImpl}!o3_commit@{o3\_\-commit}}
\subsubsection[{commitImpl}]{\setlength{\rightskip}{0pt plus 5cm}{\bf PIPE\_\-ACTIVITY} o3\_\-commit::commitImpl (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} \&}]{clk}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_a87f66e559f7376364630df8b3907e8cd}

\begin{DoxyCode}
                                                  {
    PIPE_ACTIVITY pipe_stall = PIPE_STALL;
    for (WIDTH i = 0; i < _stage_width; i++) {
        /* CHECKS */
        if (_iROB->getTableState () == EMPTY_BUFF) break;
        if (!_iROB->hasFreeRdPort (clk.now ())) break;
        dynInstruction* ins = _iROB->getFront ();
        //Assert (ins->getNumRegRd () == 0 && "instruction must have been ready l
      ong ago!"); (TODO - put it back)
        if (ins->isOnWrongPath ()) break;
        if (ins->getPipeStage () != COMPLETE) break;

        /* COMMIT INS */
        dbg.print (DBG_COMMIT, "%s: %s %llu (cyc: %d)\n", _stage_name.c_str (), "
      Commit ins", ins->getInsID (), clk.now ());
        if (ins->getInsType () == MEM) {
            ins = _iROB->getFront(); //TODO this is consuming a port count regard
      less of outcome of next step - fix
            if (g_LSQ_MGR.commit (ins, clk)) {
                ins->setPipeStage (COMMIT);
                g_GRF_MGR.commitRegs (ins);
                ins = _iROB->popFront();
            }
        } else {
            ins = _iROB->popFront();
            g_GRF_MGR.commitRegs (ins);
            delete ins;
        }

        /* STAT */
        s_ins_cnt++;
        pipe_stall = PIPE_BUSY;
    }
    return pipe_stall;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__commit_a54270cad3a81c7cce6f418517a927b98}{
\index{o3\_\-commit@{o3\_\-commit}!doCOMMIT@{doCOMMIT}}
\index{doCOMMIT@{doCOMMIT}!o3_commit@{o3\_\-commit}}
\subsubsection[{doCOMMIT}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-commit::doCOMMIT (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} \&}]{clk}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_a54270cad3a81c7cce6f418517a927b98}

\begin{DoxyCode}
                                       {
    dbg.print (DBG_COMMIT, "** %s: (cyc: %d)\n", _stage_name.c_str (), clk.now ()
      );
    /* STAT */
    regStat (clk);
    PIPE_ACTIVITY pipe_stall = PIPE_STALL;

    /* SQUASH HANDLING */
    if (!(g_var.g_pipe_state == PIPE_WAIT_FLUSH || g_var.g_pipe_state == 
      PIPE_FLUSH)) {
        pipe_stall = commitImpl (clk);
    }

    /* STAT */
    if (pipe_stall == PIPE_STALL) s_stall_cycles++;
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{classo3__commit_a32f24b682cb40b48ac43bcbeb1c8b67d}{
\index{o3\_\-commit@{o3\_\-commit}!regStat@{regStat}}
\index{regStat@{regStat}!o3_commit@{o3\_\-commit}}
\subsubsection[{regStat}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-commit::regStat (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} \&}]{clk}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_a32f24b682cb40b48ac43bcbeb1c8b67d}

\begin{DoxyCode}
                                      {
    //_iROB->regStat ();
}
\end{DoxyCode}


Here is the caller graph for this function:


\hypertarget{classo3__commit_a12cc9b965c48bdf58ede84426c78287b}{
\index{o3\_\-commit@{o3\_\-commit}!squash@{squash}}
\index{squash@{squash}!o3_commit@{o3\_\-commit}}
\subsubsection[{squash}]{\setlength{\rightskip}{0pt plus 5cm}void o3\_\-commit::squash (
\begin{DoxyParamCaption}
\item[{{\bf sysClock} \&}]{clk}
\end{DoxyParamCaption}
)}}
\label{classo3__commit_a12cc9b965c48bdf58ede84426c78287b}

\begin{DoxyCode}
                                     {
    dbg.print (DBG_SQUASH, "%s: %s (cyc: %d)\n", _stage_name.c_str (), "ROB Flush
      ", clk.now ());
    Assert (g_var.g_pipe_state == PIPE_SQUASH_ROB);
    if (_iROB->getTableSize() == 0) return;
    INS_ID squashSeqNum = g_var.getSquashSN ();
    dynInstruction* ins = NULL;
    LENGTH start_indx = 0, stop_indx = _iROB->getTableSize() - 1;
    for (LENGTH i = 0; i < _iROB->getTableSize(); i++) {
        if (_iROB->getTableSize() == 0) break;
        ins = _iROB->getNth_unsafe (i);
        Assert (ins->getPipeStage () != EXECUTE);// && ins->getPipeStage () != ME
      M_ACCESS);
        if (ins->getInsID () == squashSeqNum) {
            start_indx = i;
            Assert (ins->isOnWrongPath () == true);
        } else if (ins->getInsID () > squashSeqNum) {
            if (!ins->isOnWrongPath ()) {
                stop_indx = i - 1;
                Assert (i > start_indx);
                break;
            }
        }
    }
    Assert (_iROB->getTableSize() > stop_indx && stop_indx >= start_indx && start
      _indx >= 0);
    for (LENGTH i = _iROB->getTableSize() - 1; i > stop_indx; i--) {
        if (_iROB->getTableSize() == 0) break;
        ins = _iROB->getNth_unsafe (i);
        ins->resetStates ();
        g_var.insertFrontCodeCache(ins);
        _iROB->removeNth_unsafe (i);
        s_squash_ins_cnt++;
    }
    for (LENGTH i = stop_indx; i >= start_indx; i--) {
        if (_iROB->getTableSize() == 0) break;
        ins = _iROB->getNth_unsafe (i);
        Assert (ins->isOnWrongPath () == true);
        Assert (ins->getInsID () >= squashSeqNum);
        _iROB->removeNth_unsafe (i);
        s_squash_ins_cnt++;
        delete ins;
    }
}
\end{DoxyCode}


Here is the call graph for this function:




Here is the caller graph for this function:




The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2commit_8h}{commit.h}\item 
/home/milad/esc\_\-project/svn/PARS/src/backend/o3/\hyperlink{o3_2commit_8cpp}{commit.cpp}\end{DoxyCompactItemize}
