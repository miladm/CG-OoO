\section{Microarchitecture}
\label{sec:arch}


We find that instruction basicblocks can store up to ?


talk abouat basicblock in compiler. the ability to do energy aware optimization
passes such as scheduling, clever register allocation. these basicblocks then
must be sent off to the cpu and treated as coarse grain entities.

Figure~\ref{fig:bb_arch} shows the basic-block execution microarchitecture. The
hardware units distinguishing BBE from OoO are Basic-block Window (BB Window),
         Local Register File (LRF), Basic-block Re-order Buffer (BB-ROB), the
         Register Rename bypass line, basic-block scheduler, and the branch
         Prediction lookup line coming out from the BB Scheduler rather than
         instruction scheduler. 

BB Windows are FIFO buffers used to store up to 16 outstanding instructions.
Instructions in a BB Window execute in-order. In this figure eight BB Windows
are shown where each BB Window can issue up to one instruction per cycle. Each
cycle, the head of each BB Window is checked for ready instructions. If more
than four instructions are available, the four oldest instructions are issued.


\begin{figure}
	\centering
	\includegraphics[width=1.0\columnwidth]{fig/bb_architecture.pdf} 
	\caption{Basicblock execution microarchitecture}
	\label{fig:bb_arch}
\end{figure}


\begin{figure*}
	\centering
	\includegraphics[width=\textwidth]{fig/pipeline.pdf} 
	\caption{Basicblock execution pipeline}
	\label{fig:pipeline}
\end{figure*}

Coarse grain execution exposes energy saving opportunities in most pipeline
stages. In this section we discuss the flow of basicblocks through different
pipeline stages and elaborate on how energy is saved in each stage.


provide an example of the execution here.  it should contain a code with
multiple BB's with local/global registers, header ins.  It should show flow of
BB in a 2-wide machine. provide execution schedule, update and issue register
activity. instruction issue logic information.

Below, we discuss the various architectural components of this architecture.
Figure XX illustrates the processor stages in detail.

Discuss the overall structure of a basicblock. Focus on its unique attributes:
MOV ops for turning global to local, local registers, header instructions. Show
the image of BB.
\input{bb_structure}

Discuss the overall CPU frontend. Focus on what is differnet.
\input{cpu_frontend}

Discuss the overall CPU backend. Focus on what is differnet.
\input{cpu_backend}

Discuss BB scheduling. Perhaps here the example discussion is a great fit. (but
        cook up the example throughout this whole section and explain it in
        detail here.). This step should signify the dynamic ooo execution
aspect.
\input{scheduling}

Focus on speculation support for memory and branch and how it impacts execution.
again describe the example here.
\input{speculation}

discuss how large basicblocks are partitioned.


Talk about exception handling here.
